{% extends "base.html" %}

{% block navigation %}
{% include 'components/client_navigation.html' %}
{% endblock %}

{% block extra_head %}
<style>
  @keyframes float {

    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
    }

    50% {
      transform: translateY(-20px) rotate(5deg);
    }
  }

  @keyframes float-slow {

    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
    }

    50% {
      transform: translateY(-15px) rotate(-3deg);
    }
  }

  @keyframes title-glow {

    0%,
    100% {
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }

    50% {
      text-shadow: 0 0 40px rgba(255, 255, 255, 0.5), 0 0 60px rgba(59, 130, 246, 0.3);
    }
  }

  @keyframes sparkle {

    0%,
    100% {
      opacity: 0;
      transform: scale(0.8) rotate(0deg);
    }

    50% {
      opacity: 1;
      transform: scale(1.2) rotate(180deg);
    }
  }

  @keyframes gradient-shift {
    0% {
      background-position: 0% 50%;
    }

    50% {
      background-position: 100% 50%;
    }

    100% {
      background-position: 0% 50%;
    }
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .animate-float-slow {
    animation: float-slow 8s ease-in-out infinite;
  }

  .animate-title-glow {
    animation: title-glow 3s ease-in-out infinite;
  }

  .animate-sparkle {
    animation: sparkle 2s ease-in-out infinite;
  }

  .bg-gradient-animate {
    background-size: 200% 200%;
    animation: gradient-shift 3s ease infinite;
  }

  .glass-effect {
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .hover-lift {
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  .hover-lift:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }

  .organizer-spotlight {
    position: relative;
    overflow: hidden;
  }

  .organizer-spotlight::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transform: rotate(45deg);
    transition: all 0.6s;
    opacity: 0;
  }

  .organizer-spotlight:hover::before {
    opacity: 1;
    animation: shine 1.5s ease-in-out;
  }

  @keyframes shine {
    0% {
      transform: translateX(-100%) translateY(-100%) rotate(45deg);
    }

    100% {
      transform: translateX(100%) translateY(100%) rotate(45deg);
    }
  }

  @keyframes venue-glow {

    0%,
    100% {
      box-shadow: 0 8px 32px rgba(16, 185, 129, 0.15);
    }

    50% {
      box-shadow: 0 12px 48px rgba(16, 185, 129, 0.25), 0 0 0 1px rgba(16, 185, 129, 0.1);
    }
  }

  .venue-spotlight {
    position: relative;
    overflow: hidden;
    animation: venue-glow 3s ease-in-out infinite;
  }

  .venue-spotlight::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(16, 185, 129, 0.1), transparent);
    transform: rotate(45deg);
    transition: all 0.6s;
    opacity: 0;
  }

  .venue-spotlight:hover::before {
    opacity: 1;
    animation: shine 1.5s ease-in-out;
  }

  .description-highlight {
    position: relative;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.95));
    border-radius: 1rem;
    box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(6px);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .description-highlight::before {
    content: '';
    position: absolute;
    inset: 0;
    padding: 2px;
    background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
    border-radius: inherit;
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    -webkit-mask-composite: xor;
  }

  /* Fix UI Scale Issues */
  .container {
    max-width: 100%;
    margin: 0 auto;
  }

  @media (min-width: 1024px) {
    .grid-cols-\[1fr\,1fr\] {
      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr) !important;
    }

    .flex-col>* {
      width: 100%;
      max-width: 100%;
    }
  }

  .hero-section {
    padding: 2rem 1rem;
  }

  .compact-card {
    padding: 0.75rem;
    border-radius: 0.75rem;
  }

  .section-card {
    padding: 1.5rem;
    border-radius: 1rem;
  }

  .section-title {
    font-size: 1.5rem;
    line-height: 2rem;
  }

  .section-icon {
    width: 2.5rem;
    height: 2.5rem;
  }

  @media (min-width: 768px) {
    .hero-section {
      padding: 3rem 1rem;
    }

    .compact-card {
      padding: 1rem;
    }

    .section-card {
      padding: 2rem;
    }

    .section-title {
      font-size: 1.875rem;
      line-height: 2.25rem;
    }

    .section-icon {
      width: 3rem;
      height: 3rem;
    }
  }

  /* Read More Functionality Styles */
  .read-more-content {
    transition: all 0.3s ease-in-out;
    overflow: hidden;
  }

  .read-more-content.collapsed {
    max-height: 200px;
    position: relative;
  }

  .read-more-content.collapsed::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 40px;
    background: linear-gradient(transparent, rgba(255, 255, 255, 0.9));
    pointer-events: none;
  }

  .read-more-link {
    font-size: 0.75rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    margin-top: 0.5rem;
  }

  .read-more-link:hover {
    text-decoration: underline;
  }

  .read-more-link svg {
    width: 0.75rem;
    height: 0.75rem;
    transition: transform 0.2s ease;
  }

  /* Enhance the existing card styles */
  .bg-white\/90 {
    backdrop-filter: blur(10px);
  }

  /* Additional responsive adjustments */
  @media (max-width: 768px) {
    .read-more-content.collapsed {
      max-height: 150px;
    }

    .read-more-content.collapsed::after {
      height: 30px;
    }
  }

  /* Debug grid layout */
  @media (min-width: 1024px) {
    .debug-grid-container {
      display: grid !important;
      grid-template-columns: 1fr 1fr !important;
      gap: 2rem !important;
    }

    .debug-left-col {
      grid-column: 1 / 2 !important;
    }

    .debug-right-col {
      grid-column: 2 / 3 !important;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100">
  <!-- Hero Section with Enhanced Visual Appeal -->
  <div class="relative bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 text-white overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-10">
      <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
        <defs>
          <pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse">
            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="white" stroke-width="0.5" />
          </pattern>
        </defs>
        <rect width="100" height="100" fill="url(#grid)" />
      </svg>
    </div>

    <!-- Floating Elements -->
    <div class="absolute top-10 right-10 w-32 h-32 bg-white/5 rounded-full blur-3xl animate-float"></div>
    <div class="absolute bottom-10 left-10 w-24 h-24 bg-yellow-300/10 rounded-full blur-2xl animate-float-slow"></div>
    <div class="absolute top-1/2 left-1/4 w-16 h-16 bg-pink-300/10 rounded-full blur-xl animate-pulse"></div>
    <div class="relative container mx-auto max-w-7xl px-4 py-8 hero-section">
      <div class="flex flex-col lg:flex-row items-start justify-between gap-8">
        <div class="flex-1 space-y-4"> <!-- Status Badge -->
          {% if event.sub_status == 'registration_not_started' %}
          <div
            class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-full text-sm font-medium border border-yellow-400/20 hover:from-yellow-600 hover:to-orange-600 transition-all duration-300">
            <svg class="w-4 h-4 mr-2 animate-spin" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                clip-rule="evenodd" />
            </svg>
            ‚è≥ Registration Opening Soon
          </div>
          {% elif event.sub_status == 'registration_open' %}
          <div
            class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full text-sm font-medium border border-green-400/20 hover:from-green-600 hover:to-emerald-600 transition-all duration-300 animate-pulse">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd" />
            </svg>
            üéâ Registration Open
          </div>
          {% elif event.sub_status == 'registration_closed' %}
          <div
            class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-full text-sm font-medium border border-red-400/20 hover:from-red-600 hover:to-pink-600 transition-all duration-300">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                clip-rule="evenodd" />
            </svg>
            ‚ùå Registration Closed
          </div>
          {% elif event.sub_status == 'event_started' %}
          <div
            class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full text-sm font-medium border border-orange-400/20 hover:from-orange-600 hover:to-red-600 transition-all duration-300">
            <svg class="w-4 h-4 mr-2 animate-bounce" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm.293-13.707a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 01-1.414-1.414L12.586 9H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z"
                clip-rule="evenodd" />
            </svg>
            üî¥ Live Event
          </div>
          {% elif event.sub_status == 'certificate_available' %}
          <div
            class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-full text-sm font-medium border border-purple-400/20 hover:from-purple-600 hover:to-indigo-600 transition-all duration-300">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd" />
            </svg>
            üèÜ Certificate Ready
          </div>
          {% endif %}

          <!-- Event Badge -->
          {% if event.event_type or event.category %}
          <div
            class="inline-flex items-center px-2 py-1.5 bg-white/15 backdrop-blur-sm rounded-full text-sm font-medium border border-white/20 hover:bg-white/20 transition-all duration-300">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z"
                clip-rule="evenodd" />
            </svg>
            {{ event.event_type or event.category }}
          </div>
          {% endif %} <!-- Event Title with Animation -->
          <h1
            class="text-4xl lg:text-4xl font-bold mb-4 py-2.5 bg-gradient-to-r from-white via-blue-100 to-white bg-clip-text text-transparent leading-normal animate-title-glow">
            {{ event.event_name if event.event_name else event.name if event.name else event.title if event.title else
            "Event Details" }}
          </h1>

          <!-- Enhanced Description Preview -->
          {% if event.short_description %}
          <div class="relative">
            <p class="text-lg lg:text-xl text-blue-100 -my-1 py-3 leading-relaxed max-w-4xl font-light relative z-10">{{
              event.short_description }}</p>
            <div class="absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-xl -z-0 blur-xl">
            </div>
          </div>
          {% elif event.description %}
          <div class="relative">
            <p class="text-lg lg:text-xl text-blue-100 leading-relaxed max-w-4xl font-light relative z-10">
              {% set desc_words = event.description.split() %}
              {% if desc_words|length > 25 %}
              {{ desc_words[:25]|join(' ') }}...
              {% else %}
              {{ event.description }}
              {% endif %}
            </p>
            <div class="absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-xl -z-0 blur-xl">
            </div>
          </div>
          {% endif %}

          <!-- Enhanced Quick Info Cards -->
          <div class="flex flex-wrap gap-3 my-3 mt-6">
            {% if event.venue %}
            <div
              class="group flex items-center bg-white/10 backdrop-blur-sm rounded-xl px-4 py-2 border border-white/20 hover:bg-white/15 transition-all duration-300 hover:scale-105 transform">
              <div
                class="w-8 h-8 bg-emerald-500/20 rounded-full flex items-center justify-center mr-3 group-hover:bg-emerald-500/30 transition-colors">
                <svg class="w-4 h-4 text-emerald-300" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd"
                    d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                    clip-rule="evenodd" />
                </svg>
              </div>
              <div>
                <p class="text-xs text-blue-200">Venue</p>
                <p class="font-semibold text-sm">{{ format_venue(event.venue) }}</p>
              </div>
            </div> {% endif %}

            {% if event_duration %}
            <div
              class="group flex items-center bg-white/10 backdrop-blur-sm rounded-xl px-4 py-2 border border-white/20 hover:bg-white/15 transition-all duration-300 hover:scale-105 transform">
              <div
                class="w-8 h-8 bg-amber-500/20 rounded-full flex items-center justify-center mr-3 group-hover:bg-amber-500/30 transition-colors">
                <svg class="w-4 h-4 text-amber-300" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                    clip-rule="evenodd" />
                </svg>
              </div>
              <div>
                <p class="text-xs text-blue-200">Duration</p>
                <p class="font-semibold text-sm">{{ event_duration }}</p>
              </div>
            </div>
            {% endif %}
          </div>

        </div>
        <!-- Enhanced Action Panel -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 min-w-80 border border-white/20 shadow-xl">
          {% if event.sub_status == 'registration_open' %}
          <div class="text-center space-y-4">
            <div class="space-y-1">
              <h3 class="text-xl font-bold">Ready to Join?</h3>
              <p class="text-blue-100 text-sm">Secure your spot today!</p>
            </div>

            {% if registration_time_remaining %}
            <div class="bg-white/10 rounded-xl p-3 border border-white/20">
              <span class="text-xs text-blue-200 block">Registration closes in:</span>
              <span class="text-lg font-bold text-yellow-300">{{ registration_time_remaining }}</span>
            </div>
            {% endif %}
            <a href="/client/events/{{ event.event_id if event.event_id else event.id }}/register"
              class="block w-full bg-gradient-to-r from-white to-blue-50 text-blue-600 hover:from-blue-50 hover:to-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:shadow-xl hover:scale-105 transform">
              üöÄ Register Now
            </a>
          </div>
          {% elif event.sub_status == 'event_started' %}
          <div class="text-center space-y-4">
            <div class="space-y-1">
              <h3 class="text-xl font-bold">Event Active</h3>
              <p class="text-orange-100 text-sm">Mark your attendance now</p>
            </div>
            <a href="/client/events/{{ event.event_id if event.event_id else event.id }}/mark-attendance"
              class="block w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:shadow-xl hover:scale-105 transform">
              üìç Mark Attendance
            </a>
          </div>
          {% elif event.sub_status == 'certificate_available' %}
          <div class="text-center space-y-4">
            <div class="space-y-1">
              <h3 class="text-xl font-bold">Congratulations!</h3>
              <p class="text-purple-100 text-sm">Your certificate is ready</p>
            </div>
            <a href="/client/events/{{ event.event_id if event.event_id else event.id }}/feedback"
              class="block w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:shadow-xl hover:scale-105 transform">
              üèÜ Collect Certificate
            </a>
          </div>
          {% elif event.sub_status == 'registration_not_started' %}
          <div class="text-center space-y-4">
            <div class="space-y-1">
              <h3 class="text-xl font-bold">Coming Soon</h3>
              <p class="text-yellow-100 text-sm">Get ready to register</p>
            </div>
            {% if event.registration_start_date %}
            <div class="bg-white/10 rounded-xl p-3 border border-white/20">
              <span class="text-xs text-blue-200 block">Registration opens:</span>
              <span class="font-bold text-yellow-300 text-sm">{{ format_datetime(event.registration_start_date, 'full')
                if format_datetime else event.registration_start_date }}</span>
            </div>
            {% endif %}
            <button class="w-full bg-gray-400/50 text-gray-200 px-6 py-3 rounded-xl font-bold cursor-not-allowed"
              disabled>
              ‚è≥ Not Available Yet
            </button>
          </div>
          {% else %}
          <div class="text-center space-y-4">
            <div class="space-y-1">
              <h3 class="text-xl font-bold">Registration Closed</h3>
              <p class="text-red-100 text-sm">This event is no longer accepting registrations</p>
            </div>
            <button class="w-full bg-gray-400/50 text-gray-200 px-6 py-3 rounded-xl font-bold cursor-not-allowed"
              disabled>
              ‚ùå Registration Unavailable
            </button>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <!-- Event Timeline Section -->
  <div class="container mx-auto max-w-5xl px-4 py-4 max-w-4xl mt-8">
    <div
      class="flex flex-col md:flex-row items-center justify-between gap-4 md:gap-0 bg-white/80 rounded-2xl shadow border border-blue-100 py-6 px-2">
      {% set phases = [
      {
      'label': 'Registration Opens',
      'icon': 'üöÄ',
      'date': event.registration_start_date,
      'time': event.registration_start_time if event.registration_start_time is defined else None,
      'color': 'from-yellow-400 to-orange-400'
      },
      {
      'label': 'Registration Closes',
      'icon': '‚è∞',
      'date': event.registration_end_date,
      'time': event.registration_end_time if event.registration_end_time is defined else None,
      'color': 'from-red-400 to-pink-400'
      },
      {
      'label': 'Event Starts',
      'icon': 'üéâ',
      'date': event.start_datetime,
      'time': event.start_time if event.start_time is defined else None,
      'color': 'from-green-400 to-emerald-400'
      },
      {
      'label': 'Event Ends',
      'icon': 'üèÅ',
      'date': event.end_datetime,
      'time': event.end_time if event.end_time is defined else None,
      'color': 'from-blue-400 to-indigo-400'
      },
      {
      'label': 'Certificate Available',
      'icon': 'üèÜ',
      'date': event.certificate_end_date,
      'time': event.certificate_available_time if event.certificate_available_time is defined else None,
      'color': 'from-purple-400 to-indigo-400'
      }
      ] %} <div class="flex w-full justify-between items-center relative">
        {% for phase in phases %}
        <div class="flex flex-col items-center flex-1">
          <div
            class="w-10 h-10 rounded-full bg-gradient-to-br {{ phase.color if phase.date else 'from-gray-300 to-gray-200' }} flex items-center justify-center text-xl shadow {% if not phase.date %}opacity-60{% endif %}">
            {{ phase.icon }}
          </div>
          <div class="mt-2 text-xs font-semibold text-gray-700 text-center whitespace-nowrap">
            {{ phase.label }}
          </div>
          <div class="mt-1 text-xs text-gray-500 text-center">
            {% if phase.label == 'Certificate Available' %}
            {% if phase.date %}
            {% set date_str = phase.date|string %}
            {% if 'T' in date_str %}
            {# Handle ISO format datetime strings like 2025-06-01T00:01:00 #}
            {% set date_parts = date_str.split('T')[0].split('-') %}
            {% set time_part = date_str.split('T')[1] if 'T' in date_str else '' %}
            {% set year = date_parts[0] %}
            {% set month = date_parts[1]|int %}
            {% set day = date_parts[2]|int %}
            {% set months = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September',
            'October', 'November', 'December'] %}
            {% set suffix = 'th' %}
            {% if day % 10 == 1 and day != 11 %}{% set suffix = 'st' %}{% endif %}
            {% if day % 10 == 2 and day != 12 %}{% set suffix = 'nd' %}{% endif %}
            {% if day % 10 == 3 and day != 13 %}{% set suffix = 'rd' %}{% endif %}
            Until {{ day }}{{ suffix }} {{ months[month] }} {{ year }}
            {% if time_part %}
            {% set hour_min = time_part.split(':')[:2] %}
            {% set hour = hour_min[0]|int %}
            {% set minute = hour_min[1] %}
            {% set am_pm = 'AM' if hour < 12 else 'PM' %} {% set display_hour=12 if hour==0 else (hour if hour <=12 else
              hour - 12) %} <br>{{ display_hour }}:{{ minute }} {{ am_pm }}
              {% elif phase.time %}
              <br>{{ phase.time }}
              {% endif %}
              {% elif phase.date.strftime %}
              {# Handle datetime objects #}
              {% set day = phase.date.strftime('%d')|int %}
              {% set suffix = 'th' %}
              {% if day % 10 == 1 and day != 11 %}{% set suffix = 'st' %}{% endif %}
              {% if day % 10 == 2 and day != 12 %}{% set suffix = 'nd' %}{% endif %}
              {% if day % 10 == 3 and day != 13 %}{% set suffix = 'rd' %}{% endif %}
              Until {{ day }}{{ suffix }} {{ phase.date.strftime('%B %Y') }}
              {% if phase.time %}
              <br>{{ phase.time }}
              {% endif %}
              {% else %}
              {# Fallback for other formats #}
              Until {{ phase.date }}
              {% if phase.time %}
              <br>{{ phase.time }}
              {% endif %}
              {% endif %}
              {% else %}
              Until TBA
              {% endif %}
              {% else %}
              {% if phase.date %}
              {% set date_str = phase.date|string %}
              {% if 'T' in date_str %}
              {# Handle ISO format datetime strings like 2025-06-01T00:01:00 #}
              {% set date_parts = date_str.split('T')[0].split('-') %}
              {% set time_part = date_str.split('T')[1] if 'T' in date_str else '' %}
              {% set year = date_parts[0] %}
              {% set month = date_parts[1]|int %}
              {% set day = date_parts[2]|int %}
              {% set months = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August',
              'September', 'October', 'November', 'December'] %}
              {% set suffix = 'th' %}
              {% if day % 10 == 1 and day != 11 %}{% set suffix = 'st' %}{% endif %}
              {% if day % 10 == 2 and day != 12 %}{% set suffix = 'nd' %}{% endif %}
              {% if day % 10 == 3 and day != 13 %}{% set suffix = 'rd' %}{% endif %}
              {{ day }}{{ suffix }} {{ months[month] }} {{ year }}
              {% if time_part %}
              {% set hour_min = time_part.split(':')[:2] %}
              {% set hour = hour_min[0]|int %}
              {% set minute = hour_min[1] %}
              {% set am_pm = 'AM' if hour < 12 else 'PM' %} {% set display_hour=12 if hour==0 else (hour if hour <=12
                else hour - 12) %} <br>{{ display_hour }}:{{ minute }} {{ am_pm }}
                {% elif phase.time %}
                <br>{{ phase.time }}
                {% endif %}
                {% elif phase.date.strftime %}
                {# Handle datetime objects #}
                {% set day = phase.date.strftime('%d')|int %}
                {% set suffix = 'th' %}
                {% if day % 10 == 1 and day != 11 %}{% set suffix = 'st' %}{% endif %}
                {% if day % 10 == 2 and day != 12 %}{% set suffix = 'nd' %}{% endif %}
                {% if day % 10 == 3 and day != 13 %}{% set suffix = 'rd' %}{% endif %}
                {{ day }}{{ suffix }} {{ phase.date.strftime('%B %Y') }}
                {% if phase.time %}
                <br>{{ phase.time }}
                {% endif %}
                {% else %}
                {# Fallback for other formats #}
                {{ phase.date }}
                {% if phase.time %}
                <br>{{ phase.time }}
                {% endif %}
                {% endif %}
                {% else %}
                TBA
                {% endif %}
                {% endif %}
          </div>
        </div>
        {% if not loop.last %}
        <!-- Connecting line -->
        <div class="hidden md:block h-1 w-6 bg-gradient-to-r from-gray-200 to-gray-300 mx-1 my-5"></div>
        {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Smart Content Formatting Macro -->
  {% macro format_smart_content(content, color, section_title, icon_type='check', word_limit=40) %}
  <div class="read-more-wrapper" data-word-limit="{{ word_limit }}">
    <div class="read-more-content bg-{{ color }}-50 p-4 rounded-lg border border-{{ color }}-200">
      {% if content %}
      {% set content_lines = content.strip().split('\n') %}
      {% set has_structured_bullets = false %}
      {% set bullet_counter = 1 %}
      <!-- Check if content has any bullet points or numbered lists -->
      {% for line in content_lines %}
      {% if line.strip() %}
      {% set stripped = line.strip() %}
      {% if stripped.startswith('‚Ä¢') or stripped.startswith('-') or stripped.startswith('*') or
      stripped.startswith('‚ñ™') or stripped.startswith('‚ó¶') or stripped.startswith('‚Ä£') or
      stripped.startswith('‚óã') or stripped.startswith('‚óè') or
      (stripped[:2] and stripped[0].isdigit() and stripped[1] == '.') or
      (stripped[:3] and stripped[0].isalpha() and stripped[1] == '.') or
      (stripped[:3] and stripped[0].isalpha() and stripped[1] == ')') %}
      {% set has_structured_bullets = true %}
      {% endif %}
      {% endif %}
      {% endfor %}

      {% if has_structured_bullets %}
      <!-- Process content with explicit bullets -->
      {% for line in content_lines %}
      {% if line.strip() %}
      {% set stripped = line.strip() %}
      {% set is_bullet = false %}
      {% set bullet_content = stripped %}
      {% set bullet_type = 'check' %}
      {% set bullet_number = '' %}
      <!-- Detect different bullet formats -->
      {% if stripped.startswith('‚Ä¢') or stripped.startswith('-') or stripped.startswith('*') or
      stripped.startswith('‚ñ™') or stripped.startswith('‚ó¶') or stripped.startswith('‚Ä£') or
      stripped.startswith('‚óã') or stripped.startswith('‚óè') %}
      {% set is_bullet = true %}
      {% set bullet_content = stripped[1:].strip() %}
      {% set bullet_type = 'check' %}
      {% elif stripped[:2] and stripped[0].isdigit() and stripped[1] == '.' %}
      {% set is_bullet = true %}
      {% set bullet_content = stripped[2:].strip() %}
      {% set bullet_type = 'number' %}
      {% set bullet_number = stripped[0] %}
      {% elif stripped[:3] and stripped[0].isalpha() and stripped[1] == '.' %}
      {% set is_bullet = true %}
      {% set bullet_content = stripped[2:].strip() %}
      {% set bullet_type = 'letter' %}
      {% set bullet_number = stripped[0] %}
      {% elif stripped[:3] and stripped[0].isalpha() and stripped[1] == ')' %}
      {% set is_bullet = true %}
      {% set bullet_content = stripped[2:].strip() %}
      {% set bullet_type = 'letter' %}
      {% set bullet_number = stripped[0] %}
      {% endif %}
      {% if is_bullet %}
      <!-- Simple bullet point -->
      <div class="flex items-start space-x-3 mb-2">
        <div class="w-5 h-5 bg-{{ color }}-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
          <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
              clip-rule="evenodd" />
          </svg>
        </div>
        <div class="text-gray-700 leading-relaxed flex-1">
          {{ bullet_content }}
        </div>
      </div>
      {% else %}
      <!-- Simple text -->
      <div class="text-gray-700 leading-relaxed mb-2">
        {{ stripped }}
      </div>
      {% endif %}
      {% endif %}
      {% endfor %}
      {% else %}
      <!-- Auto-bullet creation for paragraph content without structure -->
      {% if content_lines | length == 1 %}
      {% set single_content = content_lines[0].strip() %}
      {% if '. ' in single_content and single_content.count('. ') > 1 %}
      <!-- Split by sentences and create bullets -->
      {% set sentences = single_content.split('. ') %}
      {% for sentence in sentences %}
      {% if sentence.strip() and sentence.strip() != '.' %}
      <div class="flex items-start space-x-3 mb-3">
        <div class="w-5 h-5 bg-{{ color }}-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
          <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
              clip-rule="evenodd" />
          </svg>
        </div>
        <div class="text-gray-700 leading-relaxed flex-1">
          {{ sentence.strip() }}{% if not sentence.strip().endswith('.') %}.{% endif %}
        </div>
      </div>
      {% endif %}
      {% endfor %}
      {% else %}
      <!-- Single paragraph without sentence structure - display as simple text -->
      <div class="text-gray-700 leading-relaxed">
        {{ single_content }}
      </div>
      {% endif %}
      {% else %}
      <!-- Multiple lines without bullets - display each line -->
      {% for line in content_lines %}
      {% if line.strip() %}
      <div class="text-gray-700 leading-relaxed mb-2">
        {{ line.strip() }}
      </div>
      {% endif %}
      {% endfor %}
      {% endif %}
      {% endif %}
      {% endif %}
    </div>
    <span class="read-more-link hidden text-{{ color }}-500 hover:text-{{ color }}-600">
      <span class="link-text">Read more</span>
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="12" height="12">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </span>
  </div>
  {% endmacro %} <!-- Event Details Section -->
  <div class="container mx-auto max-w-5xl px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Left Column - Event Organizers, Event Description, What to Bring -->
      <div class="flex flex-col space-y-8">
        <!-- Organizer Details -->
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-purple-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-purple-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Event Organizers</h2>
          </div>
          <div class="space-y-4">
            <!-- Event Organizers Section -->
            {% if event.organizers or event.organizer_name or event.contacts %}
            <div class="space-y-3">
              <div class="text-sm font-medium text-gray-800 mb-3">Organizing Team</div>

              {% if event.organizers %}
              <!-- Display organizers from array -->
              {% for organizer in event.organizers %}
              {% if organizer %}
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-100">
                <div class="flex items-start space-x-3">
                  <div
                    class="w-10 h-10 bg-gradient-to-br from-purple-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">
                    {{ organizer.split(' - ')[0][0].upper() if organizer.split(' - ')[0] else 'O' }}
                  </div>
                  <div class="flex-1">
                    <!-- Name and Title -->
                    <div class="font-medium text-gray-800 mb-1">{{ organizer }}</div>

                    <!-- Contact Details -->
                    {% if event.contacts %}
                    {% set organizer_name = organizer.split(' - ')[0] %}
                    {% for contact in event.contacts %}
                    {% if contact and contact.name and contact.contact %}
                    {% if contact.name.lower() == organizer_name.lower() or organizer_name.lower() in
                    contact.name.lower() or contact.name.lower() in organizer_name.lower() %}
                    <div class="mt-2 space-y-1">
                      {% if '@' in contact.contact %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                        <a href="mailto:{{ contact.contact }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ contact.contact }}</a>
                      </div>
                      {% elif contact.contact.startswith('+') or contact.contact.replace('-', '').replace(' ',
                      '').isdigit() %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path
                            d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
                        </svg>
                        <a href="tel:{{ contact.contact }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ contact.contact }}</a>
                      </div>
                      {% else %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                            clip-rule="evenodd" />
                        </svg>
                        <span class="text-sm text-gray-600">{{ contact.contact }}</span>
                      </div>
                      {% endif %}
                    </div>
                    {% endif %}
                    {% endif %}
                    {% endfor %}
                    {% endif %}
                  </div>
                </div>
              </div>
              {% endif %}
              {% endfor %}

              {% elif event.organizer_name %}
              <!-- Single organizer fallback -->
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-100">
                <div class="flex items-start space-x-3">
                  <div
                    class="w-10 h-10 bg-gradient-to-br from-purple-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">
                    {{ event.organizer_name[0].upper() }}
                  </div>
                  <div class="flex-1">
                    <!-- Name -->
                    <div class="font-medium text-gray-800 mb-1">{{ event.organizer_name }}</div>

                    <!-- Contact Details -->
                    {% if event.organizer_email or event.organizer_phone %}
                    <div class="mt-2 space-y-1">
                      {% if event.organizer_email %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                        <a href="mailto:{{ event.organizer_email }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ event.organizer_email
                          }}</a>
                      </div>
                      {% endif %}
                      {% if event.organizer_phone %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path
                            d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
                        </svg>
                        <a href="tel:{{ event.organizer_phone }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ event.organizer_phone
                          }}</a>
                      </div>
                      {% endif %}
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>

              {% elif event.contacts %}
              <!-- Contacts only fallback -->
              {% for contact in event.contacts %}
              {% if contact and contact.name and contact.contact %}
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-100">
                <div class="flex items-start space-x-3">
                  <div
                    class="w-10 h-10 bg-gradient-to-br from-purple-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">
                    {{ contact.name[0].upper() }}
                  </div>
                  <div class="flex-1">
                    <!-- Name -->
                    <div class="font-medium text-gray-800 mb-1">{{ contact.name }}</div>

                    <!-- Contact Details -->
                    <div class="mt-2 space-y-1">
                      {% if '@' in contact.contact %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                        <a href="mailto:{{ contact.contact }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ contact.contact }}</a>
                      </div>
                      {% elif contact.contact.startswith('+') or contact.contact.replace('-', '').replace(' ',
                      '').isdigit() %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path
                            d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
                        </svg>
                        <a href="tel:{{ contact.contact }}"
                          class="text-sm text-blue-600 hover:text-blue-800 transition-colors">{{ contact.contact }}</a>
                      </div>
                      {% else %}
                      <div class="flex items-center">
                        <svg class="w-4 h-4 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                            clip-rule="evenodd" />
                        </svg>
                        <span class="text-sm text-gray-600">{{ contact.contact }}</span>
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
              {% endfor %}
              {% endif %}
            </div>
            {% endif %}

            <!-- Organization -->
            {% if event.organization %}
            <div class="bg-purple-50 p-3 rounded-lg border border-purple-200 mt-4">
              <div class="text-sm font-medium text-purple-800 mb-1">Organization</div>
              <div class="text-sm text-purple-700">{{ event.organization }}</div>
            </div>
            {% endif %}

            <!-- Additional Notes -->
            {% if event.organizer_notes %}
            <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 mt-4">
              <div class="text-sm font-medium text-gray-800 mb-1">Additional Information</div>
              <div class="text-sm text-gray-700">{{ event.organizer_notes }}</div>
            </div>
            {% endif %}
          </div>
        </div>

        <!-- Event Description Card -->
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-blue-100 p-6 h-fit">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Event Description</h2>
          </div>

          <div class="prose prose-gray max-w-none">
            {% if event.description %} <div class="read-more-wrapper" data-word-limit="50">
              <div class="read-more-content text-gray-700 leading-relaxed whitespace-pre-line">{{ event.description }}
              </div>
              <span class="read-more-link hidden text-blue-500 hover:text-blue-600">
                <span class="link-text">Read more</span>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="12" height="12">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </span>
            </div>
            {% elif event.detailed_description %} <div class="read-more-wrapper" data-word-limit="50">
              <div class="read-more-content text-gray-700 leading-relaxed">{{ event.detailed_description }}</div> <span
                class="read-more-link hidden text-blue-500 hover:text-blue-600">
                <span class="link-text">Read more</span>
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="12" height="12">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
          </div>
          {% else %}
          <div class="text-gray-500 italic">No description available for this event.</div>
          {% endif %}
        </div>
        <!-- What to Bring -->
        {% if event.what_to_bring %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-cyan-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-cyan-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zM8 6a2 2 0 114 0v1H8V6z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">What to Bring</h2>
          </div>
          {{ format_smart_content(event.what_to_bring, 'cyan', '', 'package', 30) }}
        </div> {% endif %}

        {% if event.objectives or event.agenda %}
        <div class="mt-6 pt-6 border-t border-gray-200"> {% if event.objectives %}
          <h3 class="text-lg font-semibold text-gray-800 mb-3">Objectives</h3>
          <div class="read-more-wrapper" data-word-limit="40">
            <div class="read-more-content text-gray-700 leading-relaxed mb-4 whitespace-pre-line">{{ event.objectives }}
            </div>
            <span class="read-more-link hidden text-gray-500 hover:text-gray-600">
              <span class="link-text">Read more</span>
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="12" height="12">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </span>
          </div>
          {% endif %}
          {% if event.agenda %}
          <h3 class="text-lg font-semibold text-gray-800 mb-3">Agenda</h3>
          <div class="read-more-wrapper" data-word-limit="40">
            <div class="read-more-content text-gray-700 leading-relaxed whitespace-pre-line">{{ event.agenda }}</div>
            <span class="read-more-link hidden text-gray-500 hover:text-gray-600">
              <span class="link-text">Read more</span>
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="12" height="12">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </span>
          </div> {% endif %}
        </div>
        {% endif %}
      </div>
      <div class="flex flex-col space-y-8">

        <!-- Registration Details -->
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-green-100 p-6 w-full max-w-full">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zM8 6a2 2 0 114 0v1H8V6z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Registration Details</h2>
          </div>

          <div class="space-y-4">
            <!-- Registration Mode -->
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Mode</span>
              <span class="text-sm font-semibold text-gray-800">
                {% if event.mode %}
                {% if event.mode == 'online' %}üåê Online
                {% elif event.mode == 'offline' %}üìç Offline
                {% elif event.mode == 'hybrid' %}üîÑ Hybrid
                {% else %}{{ event.mode|title }}
                {% endif %}
                {% else %}Not specified
                {% endif %}
              </span>
            </div>
            <!-- Registration Type -->
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Type</span>
              <span class="text-sm font-semibold text-gray-800">
                {% if event.registration_type %}
                {% if event.registration_type == 'free' %}üÜì Free
                {% elif event.registration_type == 'paid' %}üí∞ Paid
                {% else %}{{ event.registration_type|title }}
                {% endif %}
                {% else %}Not specified
                {% endif %}
              </span>
            </div>

            <!-- Registration Mode -->
            {% if event.registration_mode %}
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Registration Mode</span>
              <span class="text-sm font-semibold text-gray-800">
                {% if event.registration_mode == 'individual' %}üë§ Individual
                {% elif event.registration_mode == 'team' %}üë• Team Based
                {% else %}{{ event.registration_mode|title }}
                {% endif %}
              </span>
            </div>
            {% endif %}

            <!-- Team Size (only for team-based registration) -->
            {% if event.registration_mode == 'team' and (event.team_size_min or event.team_size_max) %}
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Team Size</span>
              <span class="text-sm font-semibold text-gray-800">
                {% if event.team_size_min and event.team_size_max %}
                {{ event.team_size_min }} - {{ event.team_size_max }} members
                {% elif event.team_size_min %}
                Min: {{ event.team_size_min }} members
                {% elif event.team_size_max %}
                Max: {{ event.team_size_max }} members
                {% endif %}
              </span>
            </div>
            {% endif %}

            <!-- Registration Fee -->
            {% if event.registration_fee and event.registration_fee > 0 %}
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Fee</span>
              <span class="text-sm font-semibold text-green-600">‚Çπ{{ event.registration_fee }}</span>
            </div>
            {% endif %}            <!-- Participants Range -->
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              {% if event.registration_mode and event.registration_mode.lower() == 'team' %}
                <span class="text-sm font-medium text-gray-600">Team Size</span>
              {% else %}
                <span class="text-sm font-medium text-gray-600">Participants</span>
              {% endif %}
              <span class="text-sm font-semibold text-gray-800">
                {% if event.min_participants or event.max_participants %}
                {% if event.min_participants and event.max_participants %}
                {{ event.min_participants }} - {{ event.max_participants }}
                {% elif event.min_participants %}
                Min: {{ event.min_participants }}
                {% elif event.max_participants %}
                Max: {{ event.max_participants }}
                {% endif %}
                {% else %}
                No limit specified
                {% endif %}
              </span>
            </div>            <!-- Current Registrations -->
            {% if registration_stats and registration_stats.total_registrations is defined %}
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-gray-600">Registered</span>
              {% if event.registration_mode and event.registration_mode.lower() == 'team' %}
                <div class="text-right">
                  <span class="text-sm font-semibold text-blue-600">
                    {% if registration_stats.total_teams is defined %}
                      {{ registration_stats.total_teams }}
                    {% else %}
                      0
                    {% endif %}
                    teams
                  </span>
                  {% if registration_stats.total_participants is defined and registration_stats.total_participants > 0 %}
                    <div class="text-xs text-gray-500">{{ registration_stats.total_participants }} total participants</div>
                  {% endif %}
                </div>
              {% else %}
                <span class="text-sm font-semibold text-blue-600">
                  {% if registration_stats.total_participants is defined %}
                    {{ registration_stats.total_participants }}
                  {% else %}
                    {{ registration_stats.total_registrations or 0 }}
                  {% endif %}
                  participants
                </span>
              {% endif %}
            </div>
            {% endif %}
            <!-- Fee Details -->
            {% if event.registration_fee and event.registration_fee > 0 %}
            <div class="py-2">
              <span class="text-sm font-medium text-gray-600 block mb-2">Fee Details</span>
              <div class="text-sm text-gray-700 bg-green-50 p-3 rounded-lg border border-green-200">
                <div class="flex justify-between items-center mb-2">
                  <span class="font-medium">Registration Fee:</span>
                  <span class="text-green-600 font-bold">‚Çπ{{ event.registration_fee }}</span>
                </div>
                {% if event.fee_description %}
                <div class="text-xs text-gray-600 mt-2">
                  <span class="font-medium">Description:</span> {{ event.fee_description }}
                </div>
                {% endif %}
                {% if event.fee_includes %}
                <div class="text-xs text-gray-600 mt-2">
                  <span class="font-medium">Includes:</span> {{ event.fee_includes }}
                </div>
                {% endif %}
                {% if event.payment_method %}
                <div class="text-xs text-gray-600 mt-1">
                  <span class="font-medium">Payment Method:</span> {{ event.payment_method }}
                </div>
                {% endif %}
              </div>
            </div>
            {% endif %}
          </div>
        </div>

        <!-- Target Goals & Outcomes Cards -->
        {% if event.target_goals or event.target_outcomes or event.expected_outcomes or event.learning_outcomes or
        event.success_metrics %}

        {% if event.target_goals %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-amber-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-amber-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Target Goals</h2>
          </div>
          {{ format_smart_content(event.target_goals, 'amber', '', '') }}
        </div>
        {% endif %}

        {% if event.target_outcomes %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-orange-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-orange-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Target Outcomes</h2>
          </div>
          {{ format_smart_content(event.target_outcomes, 'orange', '', '', 35) }}
        </div>
        {% endif %}

        {% if event.expected_outcomes %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-green-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Expected Outcomes</h2>
          </div>
          {{ format_smart_content(event.expected_outcomes, 'green', '', '') }}
        </div>
        {% endif %}

        {% if event.learning_outcomes %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-blue-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Learning Outcomes</h2>
          </div>
          {{ format_smart_content(event.learning_outcomes, 'blue', '', '') }}
        </div>
        {% endif %}

        {% if event.success_metrics %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-purple-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-purple-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Success Metrics</h2>
          </div>
          {{ format_smart_content(event.success_metrics, 'purple', '', '') }}
        </div>
        {% endif %} {% endif %}

        <!-- Prerequisites Card -->
        {% if event.prerequisites %}
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-red-100 p-6">
          <div class="flex items-center mb-4">
            <div class="w-8 h-8 bg-red-500/20 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                  clip-rule="evenodd" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">Prerequisites</h2>
          </div>
          <div class="text-gray-700">
            {{ format_smart_content(event.prerequisites, 'red', '', '') }}
          </div>
        </div>
        {% endif %}
      </div>
    </div>

    <!-- Right Column - Registration Details, Target Outcomes, Prerequisites -->

  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Initialize read-more functionality for all wrappers
    const readMoreWrappers = document.querySelectorAll('.read-more-wrapper');

    readMoreWrappers.forEach(wrapper => {
      const content = wrapper.querySelector('.read-more-content');
      const link = wrapper.querySelector('.read-more-link');
      const wordLimit = parseInt(wrapper.dataset.wordLimit) || 40;

      if (!content || !link) return;

      // Get the original content text
      const originalText = content.textContent || content.innerText;
      const words = originalText.trim().split(/\s+/);

      // Only show read-more if content exceeds word limit
      if (words.length > wordLimit) {
        // Create truncated version
        const truncatedWords = words.slice(0, wordLimit);
        const truncatedText = truncatedWords.join(' ') + '...';

        // Store original HTML content
        const originalHTML = content.innerHTML;

        // Create truncated HTML by replacing text content while preserving structure
        let truncatedHTML = originalHTML;

        // For simple text content, replace directly
        if (content.children.length === 0) {
          truncatedHTML = truncatedText;
        } else {
          // For complex HTML content, we need to be more careful
          const textNodes = getTextNodes(content);
          let wordCount = 0;
          let shouldTruncate = false;

          textNodes.forEach(node => {
            const nodeWords = (node.textContent || '').trim().split(/\s+/);
            if (wordCount + nodeWords.length > wordLimit && !shouldTruncate) {
              const remainingWords = wordLimit - wordCount;
              if (remainingWords > 0) {
                node.textContent = nodeWords.slice(0, remainingWords).join(' ') + '...';
              } else {
                node.textContent = '...';
              }
              shouldTruncate = true;
            } else if (shouldTruncate) {
              node.textContent = '';
            }
            wordCount += nodeWords.length;
          });

          truncatedHTML = content.innerHTML;
          content.innerHTML = originalHTML; // Restore original
        }

        // Set initial state to collapsed
        content.innerHTML = truncatedHTML;
        content.classList.add('collapsed');
        link.classList.remove('hidden');

        // Add click event listener
        link.addEventListener('click', function () {
          const isCollapsed = content.classList.contains('collapsed');
          const linkText = link.querySelector('.link-text');
          const chevron = link.querySelector('svg');

          if (isCollapsed) {
            // Expand
            content.innerHTML = originalHTML;
            content.classList.remove('collapsed');
            linkText.textContent = 'Read less';
            chevron.style.transform = 'rotate(180deg)';
          } else {
            // Collapse
            content.innerHTML = truncatedHTML;
            content.classList.add('collapsed');
            linkText.textContent = 'Read more';
            chevron.style.transform = 'rotate(0deg)';
          }
        });
      } else {
        // Content doesn't exceed limit, hide the link
        link.classList.add('hidden');
      }
    });

    // Helper function to get all text nodes
    function getTextNodes(element) {
      const textNodes = [];
      const walker = document.createTreeWalker(
        element,
        NodeFilter.SHOW_TEXT,
        null,
        false
      );

      let node;
      while (node = walker.nextNode()) {
        if (node.textContent.trim()) {
          textNodes.push(node);
        }
      }

      return textNodes;
    }
  });
</script>

{% endblock %}